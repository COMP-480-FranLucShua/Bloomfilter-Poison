#
# ============================================================
# Poisoning Bloom Filters â€“ Experiment Configuration
# ============================================================

# ----------------------------
# Global Reproducibility
# ----------------------------
seed: 42

# ------------------
# Bloom Filter
# ------------------
bloom_filter:
  bit_array_size: 1000000
  num_hash_functions: 7
  target_false_positive_rate: 0.01

# ------------------
# System Emulator
# ------------------
system_emulator:
  gamma_distribution:
    shape: 2.0
    scale: 1.0

  fixed_positive_delay_ms: 5.0   # Extra delay for Bloom positives

# ------------------
# Dataset
# ------------------
dataset:
  path: "data/malicious_urls.txt"
  benign_label: 0
  malicious_label: 1

  # Preload phase
  preload_malicious_count: 50000

  # Pools
  attacker_url_pool_size: 600000
  evaluation_set_size: 50000

# ------------------
# Experiment Loop
# ------------------
experiment:
  max_insertions_per_attacker: 100000
  measurement_interval: 1000     # Measure FP rate every N insertions
  num_trials: 5                  # For averaging results

# ------------------
# Attackers
# ------------------
attackers:
  # Order determines execution order
  enabled:
    - naive
    - timing
    - sigma

  # ------------------------
  # Attacker 1: Naive
  # ------------------------
  naive:
    batch_size: 1

  # ------------------------
  # Attacker 2: Timing Heuristic
  # ------------------------
  timing:
    # Training phase
    initial_sample_size: 1000
    kmeans_clusters: 2

    # Optional safety controls
    max_retries_per_step: 10


  sigma: {}

# ----------------------------
# Output & Logging
# ----------------------------
logging:
  log_level: "INFO"
  save_raw_results: true
  output_directory: "results/"
  plot_formats: ["png", "pdf"]

# ----------------------------
# Evaluation Metrics
# ----------------------------
metrics:
  track_false_positive_rate: true
  track_query_latency: true
  track_insertion_efficiency: true
